(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Templating=c.Templating||{};e=d.Runtime=d.Runtime||{};f=e.Server=e.Server||{};g=f.TemplateInitializer=f.TemplateInitializer||{};h=b&&b.Obj;i=f.TemplateInstances=f.TemplateInstances||{};j=f.Handler=f.Handler||{};k=f.ProviderBuilder=f.ProviderBuilder||{};l=f.TemplateInstance=f.TemplateInstance||{};m=e.Client=e.Client||{};n=m.ClientTemplateInstanceHandlers=m.ClientTemplateInstanceHandlers||{};o=b&&b.Collections;p=o&&o.Dictionary;q=b&&b.Runtime;r=b&&b.Arrays;s=b&&b.Unchecked;t=c&&c.TemplateHoleModule;u=t&&t.VarStr;v=c&&c.Var$1;w=t&&t.VarFloatUnchecked;x=t&&t.VarBool;y=t&&t.VarDateTime;z=t&&t.VarFile;A=t&&t.VarDomElement;B=b&&b.Operators;C=c&&c.Doc;D=c&&c.Client;E=D&&D.Templates;F=b&&b.Slice;G=c&&c.View;H=b&&b.Activator;I=o&&o.HashSet;J=b&&b.Enumerator;K=b&&b.Seq;L=t&&t.AfterRenderQ;M=t&&t.EventQ;N=a.System;O=N&&N.Guid;g.$cctor=function(){g.$cctor=a.ignore;g.initialized=new p.New$5();};g=f.TemplateInitializer=q.Class({get_Vars:function(){g.$cctor();return this.vars;},get_Id:function(){g.$cctor();return this.id;},InitInstance:function(P){var Q,R,S,T,U;g.$cctor();R=g.GetHolesFor(P);S=this.vars;for(T=0,U=S.length-1;T<=U;T++)(function(){var V,W,X,Y,Z,_0,_1,_2,_3,_4,_5;V=r.get(S,T);W=V[1];X=V[2];Y=V[0];return!R.ContainsKey(Y)?R.set_Item(Y,s.Equals(W,0)?new u.New(Y,v.Create$1((Z=X==null?null:{$:1,$0:X.$0},Z==null?"":Z.$0))):s.Equals(W,1)?new w.New(Y,v.Create$1((_0=X==null?null:{$:1,$0:X.$0},_0==null?0:_0.$0))):s.Equals(W,2)?new x.New(Y,v.Create$1((_1=X==null?null:{$:1,$0:X.$0},_1==null?false:_1.$0))):s.Equals(W,3)?new y.New(Y,v.Create$1((_2=X==null?null:{$:1,$0:X.$0},_2==null?-8640000000000000:_2.$0))):s.Equals(W,4)?new z.New(Y,v.Create$1((_3=X==null?null:{$:1,$0:X.$0},_3==null?[]:_3.$0))):s.Equals(W,5)?new A.New(Y,v.Create$1({$:1,$0:(_4=X==null?null:{$:1,$0:X.$0},(_5=self.document.querySelector("[ws-dom="+Y+"]"),_4==null?_5:_4.$0))})):B.FailWith("Invalid value type")):null;}());this.instance=new l.New({$:0,$0:R},C.get_Empty());},get_Instance:function(){g.$cctor();return q.GetOptional(this.instance).$0;},$postinit:function(P){g.$cctor();E.RunFullDocTemplate([]);},$init:function(P){g.$cctor();},$preinit:function(P){var Q,R,S,T,U,V,W,X;g.$cctor();this.InitInstance(P);Q=self.document.querySelectorAll("[ws-var^='"+P+"::']");for(R=0,S=Q.length-1;R<=S;R++){T=Q[R];U=T.getAttribute("ws-var");V=F.string(U,{$:1,$0:P.length+2},null);W=this.get_Instance().Hole(V);X=W.WithName(U);E.GlobalHoles().set_Item(X.get_Name(),X);g.applyVarHole(T,W);}}},h,g);g.applyVarHole=function(P,Q){g.$cctor();Q.ApplyVarHole(P);};g.applyTypedVarHole=function(P,Q,R){var S;g.$cctor();S=P(Q);S[0](R);G.Sink(S[1](R),S[2]);};g.GetOrAddHoleFor=function(P,Q,R){var S,T,U,V;g.$cctor();S=g.GetHolesFor(P);T=(U=null,[S.TryGetValue(Q,{get:function(){return U;},set:function(W){U=W;}}),U]);return T[0]?T[1]:(V=R(),(S.set_Item(Q,V),V));};g.GetHolesFor=function(P){var Q,R,S;g.$cctor();Q=(R=null,[g.initialized.TryGetValue(P,{get:function(){return R;},set:function(T){R=T;}}),R]);return Q[0]?Q[1]:(S=new p.New$5(),(g.initialized.set_Item(P,S),S));};g.get_Initialized=function(){g.$cctor();return g.initialized;};g.New=q.Ctor(function(P,Q){g.$cctor();h.New.call(this);this.vars=Q;q.SetOptional(this,"instance",null);this.id=P;},g);i=f.TemplateInstances=q.Class({},h,i);i.GetInstance=function(P){return(H.Instances())[P].get_Instance();};i.New=q.Ctor(function(){h.New.call(this);},i);j.AfterRenderQ2$204$42=function(P,Q){return function(R){var S;S=i.GetInstance(P);S.SetAnchorRoot(R);Q({Vars:S,Anchors:S,Target:R,Event:null});};};j.EventQ2$188$36=function(P,Q){return function(R){return function(S){var T;T=i.GetInstance(P);T.SetAnchorRoot(R);return Q({Vars:T,Anchors:T,Target:R,Event:S});};};};j.CompleteHoles=function(P,Q,R){var T,U,V,W,X;function S(Y,Z,_0){var _1;return U.Contains(Y)?null:(_1=s.Equals(Z,0)?g.GetOrAddHoleFor(P,Y,function(){return new u.New(Y,v.Create$1(""));}):s.Equals(Z,1)?g.GetOrAddHoleFor(P,Y,function(){return new w.New(Y,v.Create$1(0));}):s.Equals(Z,2)?g.GetOrAddHoleFor(P,Y,function(){return new x.New(Y,v.Create$1(false));}):s.Equals(Z,3)?g.GetOrAddHoleFor(P,Y,function(){return new y.New(Y,v.Create$1(-8640000000000000));}):s.Equals(Z,4)?g.GetOrAddHoleFor(P,Y,function(){return new z.New(Y,v.Create$1([]));}):s.Equals(Z,5)?g.GetOrAddHoleFor(P,Y,function(){var _2;_2=self.document.querySelector("[ws-dom="+Y+"]");_2.removeAttribute("ws-dom");return new A.New(Y,v.Create$1({$:1,$0:_2}));}):B.FailWith("Invalid value type"),(T.set_Item(Y,_1),{$:1,$0:_1}));}T=new p.New$5();U=new I.New$3();V=J.Get(Q);try{while(V.MoveNext()){W=V.Current();X=W.get_Name();U.SAdd(X);T.set_Item(X,W);}}finally{if(typeof V=="object"&&"Dispose"in V)V.Dispose();}return[K.append(Q,r.choose(function(Y){return S(Y[0],Y[1],Y[2]);},R)),{$:0,$0:T}];};j.AfterRenderQ2=function(P,Q,R,S){return new L.New(Q,function(T){var U;U=R();U.SetAnchorRoot(T);S({Vars:U,Anchors:U,Target:T,Event:null});});};j.EventQ2=function(P,Q,R,S){return new M.New(Q,function(T){return function(U){var V;V=R();V.SetAnchorRoot(T);return S({Vars:V,Anchors:V,Target:T,Event:U});};});};k=f.ProviderBuilder=q.Class({},h,k);k.New=q.Ctor(function(P){var Q;h.New.call(this);this.i=null;this.k=(Q=O.NewGuid(),a.String(Q));this.h=q.MarkResizable([]);this.s=P;},k);k.New$1=q.Ctor(function(){var P;h.New.call(this);this.i=null;this.k=(P=O.NewGuid(),a.String(P));this.h=q.MarkResizable([]);q.SetOptional(this,"s",null);},k);l=f.TemplateInstance=q.Class({Anchor:function(P){function Q(R){var S;while(true){S=R.querySelector("[ws-anchor=\""+a.String(P)+"\"]");if(S==null&&!(R.parentElement==null))R=R.parentElement;else return S;}}return Q(this.anchorRoot);},SetAnchorRoot:function(P){this.anchorRoot=P;},Hole:function(P){return this.allVars.Item(P);},get_Doc:function(){return this.doc;}},h,l);l.New=q.Ctor(function(P,Q){h.New.call(this);this.doc=Q;this.allVars=P.$==0?P.$0:B.FailWith("Should not happen");this.anchorRoot=null;},l);n.AfterRenderQ2Client=function(P,Q,R){var S;S=i.GetInstance(P);S.SetAnchorRoot(Q);R({Vars:S,Anchors:S,Target:Q,Event:null});};n.EventQ2Client=function(P,Q,R,S){var T;T=i.GetInstance(P);T.SetAnchorRoot(Q);S({Vars:T,Anchors:T,Target:Q,Event:R});};m.AfterRenderQ2$71$26=function(P){return function(){P();};};m.Box=a.id;}(self));
